# RedELK v3.0 - Project Structure

This document describes the clean, organized structure of RedELK v3.0.

## 📁 Root Directory

```
RedELK/
├── install.py              # Main installer (v3.0 - RECOMMENDED)
├── install-agent.py        # Agent installer for C2/redirectors
├── redelk                  # Management CLI tool
├── Makefile               # Convenience commands
├── env.template           # Configuration template
├── initial-setup.sh       # Legacy installer (v2.x)
├── VERSION                # Version file (3.0.0)
├── LICENSE                # BSD-3-Clause license
├── README.md              # Main documentation
├── CHANGELOG.md           # Version history
└── releasenotes.txt       # Legacy release notes
```

## 📚 Documentation (`docs/`)

```
docs/
├── QUICKSTART.md          # 5-minute setup guide
├── ARCHITECTURE.md        # Technical architecture
└── TROUBLESHOOTING.md     # Problem solving guide
```

**Quick Links:**
- **Getting Started**: [docs/QUICKSTART.md](docs/QUICKSTART.md)
- **Understanding RedELK**: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)
- **Need Help?**: [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md)

## 🔧 Scripts (`scripts/`)

```
scripts/
├── generate-certificates.py   # Auto-generate TLS certificates
└── health-check.py           # System health monitoring
```

**Usage:**
```bash
# Generate certificates
python3 scripts/generate-certificates.py --auto

# Check system health
python3 scripts/health-check.py
```

## 🐳 ELK Server (`elkserver/`)

Main server deployment directory.

### Docker Configuration
```
elkserver/
├── redelk-full-v3.yml     # Modern Docker Compose (RECOMMENDED)
├── redelk-full.yml        # Legacy full install (v2.x)
├── redelk-limited.yml     # Legacy limited install
├── redelk-dev.yml         # Development mode
├── install-elkserver.sh   # Legacy installer
└── init-letsencrypt.sh    # Let's Encrypt setup
```

### Docker Images (`elkserver/docker/`)
```
docker/
├── redelk-base/           # Background tasks & enrichment
├── redelk-elasticsearch/  # Elasticsearch 8.x
├── redelk-kibana/        # Kibana 8.x
├── redelk-logstash/      # Logstash 8.x
└── redelk-jupyter/       # Jupyter notebooks
```

### Mounted Configurations (`elkserver/mounts/`)
```
mounts/
├── bloodhound-config/     # BloodHound settings
├── elasticsearch-config/  # ES JVM options
├── jupyter-workbooks/     # Analysis notebooks
├── logstash-config/       # Log parsing rules
├── nginx-config/          # Web server config
├── redelk-config/         # RedELK settings
├── redelk-logs/          # Application logs
├── redelk-www/           # Web content
└── sample-data/          # Example data for testing
```

## 📡 C2 Server Configuration (`c2servers/`)

Files for deploying agents on Command & Control servers.

```
c2servers/
├── install-c2server.sh         # Legacy installer (v2.x)
├── filebeat/                   # Filebeat configurations
│   ├── filebeat_redelk_main.yml.example
│   └── inputs.d/              # Per-C2 framework configs
│       ├── filebeat_cobaltstrike.yml
│       ├── filebeat_sliver.yml
│       ├── filebeat_poshc2.yml
│       └── filebeat_outflankstage1.yml
├── cron.d/                    # Scheduled tasks
└── scripts/                   # Data export scripts
```

**Supported C2 Frameworks:**
- Cobalt Strike
- Sliver
- PoshC2
- Outflank Stage1

## 🔀 Redirector Configuration (`redirs/`)

Files for deploying agents on traffic redirectors.

```
redirs/
├── install-redir.sh           # Legacy installer (v2.x)
└── filebeat/                  # Filebeat configuration
    └── filebeat.yml.example   # Redirector config template
```

**Supported Redirectors:**
- Apache HTTP Server
- Nginx
- HAProxy

## 🔐 Certificates (`certs/`)

TLS certificate configuration.

```
certs/
└── config.cnf.example         # OpenSSL configuration template
```

**Note:** Certificates are auto-generated by `scripts/generate-certificates.py` or `install.py`.

## 📖 Examples (`example-data-and-configs/`)

Sample configurations and test data.

```
example-data-and-configs/
├── Apache/                    # Apache redirector config
├── CobaltStrike/             # CS malleable profiles
├── ExampleData/              # Sample logs for testing
├── HAProxy/                  # HAProxy config
├── nginx/                    # Nginx redirector config
├── RedELKFieldnames.md       # Field documentation (v1)
└── RedELKFieldnamesV2.md     # Field documentation (v2)
```

## 🛠️ Helper Scripts (`helper-scripts/`)

Utility scripts for maintenance.

```
helper-scripts/
├── export_kibana_config.py   # Export Kibana dashboards
├── get_fields_mappings.sh    # Get ES field mappings
├── reset_ES_readwrite.sh     # Reset ES permissions
└── requirements.txt          # Python dependencies
```

## 🖼️ Images (`images/`)

Screenshots and diagrams for documentation.

```
images/
├── redelk_overview.png       # Architecture diagram
├── dashboard-*.png           # Dashboard screenshots
└── redelk_*.jpg             # UI screenshots
```

## 🗂️ File Categories

### **Essential for Installation (v3.0)**
- `install.py` - Main installer
- `install-agent.py` - Agent installer
- `redelk` - Management CLI
- `Makefile` - Convenience commands
- `env.template` - Config template
- `scripts/generate-certificates.py` - Cert generator
- `elkserver/redelk-full-v3.yml` - Docker Compose

### **Documentation**
- `README.md` - Getting started
- `CHANGELOG.md` - Version history
- `docs/QUICKSTART.md` - 5-min guide
- `docs/ARCHITECTURE.md` - Technical details
- `docs/TROUBLESHOOTING.md` - Problem solving

### **Configuration Templates**
- `env.template` - Environment variables
- `certs/config.cnf.example` - Certificate config
- `elkserver/mounts/*/` - Service configs

### **Legacy Files (v2.x - Backward Compatibility)**
- `initial-setup.sh` - Old installer
- `elkserver/install-elkserver.sh` - Old ELK installer
- `c2servers/install-c2server.sh` - Old C2 installer
- `redirs/install-redir.sh` - Old redirector installer
- `elkserver/redelk-full.yml` - Old Docker Compose

### **Support Files**
- `helper-scripts/` - Maintenance utilities
- `example-data-and-configs/` - Examples
- `images/` - Documentation images

## 📦 Installation Files Generated

During installation, these files are created:

```
Generated Files:
├── elkserver/.env             # Environment variables (from env.template)
├── elkserver/redelk_passwords.cfg  # Generated passwords
├── certs/*.crt               # TLS certificates
├── certs/*.key               # Private keys
├── elkserver/mounts/certs/   # Distributed certificates
├── c2servers.tgz             # C2 deployment package
└── redirs.tgz               # Redirector deployment package
```

## 🚫 Files to Ignore

Add to `.gitignore`:

```gitignore
# Generated during installation
*.tgz
certs/*.crt
certs/*.key
certs/*.csr
certs/*.srl
certs/*.pem
elkserver/.env
elkserver/redelk_passwords.cfg
elkserver/mounts/certs/*
sshkey/

# Docker volumes
elkserver/mounts/redelk-logs/*.log
elkserver/mounts/redelk-www/c2logs/*

# Python
__pycache__/
*.pyc
*.pyo
*.egg-info/

# Logs
*.log
redelk-install.log
redelk-inintialsetup.log
```

## 🔄 Upgrade Path

### From v2.x to v3.0

**Keep:**
- All configuration in `elkserver/mounts/redelk-config/`
- Data in Docker volumes
- Custom dashboards and visualizations

**Migrate:**
1. Backup existing installation
2. Run new installer: `python3 install.py`
3. Update agents: `python3 install-agent.py`
4. Copy custom configurations

## 📊 Size Reference

```
Total Size: ~50MB (without Docker images)

Breakdown:
- Documentation: ~150KB
- Python Scripts: ~100KB
- Docker Configs: ~50KB
- Example Data: ~45MB
- Images: ~5MB
- Templates: ~500KB
```

## 🎯 Quick Navigation

**For Installation:**
1. Start here: [README.md](README.md)
2. Quick setup: [docs/QUICKSTART.md](docs/QUICKSTART.md)
3. Run: `install.py`

**For Operations:**
1. Management: `./redelk` or `make`
2. Health: `scripts/health-check.py`
3. Troubleshooting: [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md)

**For Development:**
1. Architecture: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)
2. Examples: `example-data-and-configs/`
3. Helper scripts: `helper-scripts/`

## 📝 Notes

- **v3.0 files** are the recommended way to use RedELK
- **Legacy (v2.x) files** are kept for backward compatibility
- **Documentation** is comprehensive and up-to-date
- **Examples** help understand configurations
- **Helper scripts** assist with maintenance

---

**Version**: 3.0.0  
**Last Updated**: October 2024  
**Status**: Clean and organized for production use


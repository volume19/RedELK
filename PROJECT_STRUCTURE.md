# RedELK v3.0 - Project Structure

This document describes the clean, organized structure of RedELK v3.0.

## ğŸ“ Root Directory

```
RedELK/
â”œâ”€â”€ install.py              # Main installer (v3.0 - RECOMMENDED)
â”œâ”€â”€ install-agent.py        # Agent installer for C2/redirectors
â”œâ”€â”€ redelk                  # Management CLI tool
â”œâ”€â”€ Makefile               # Convenience commands
â”œâ”€â”€ env.template           # Configuration template
â”œâ”€â”€ initial-setup.sh       # Legacy installer (v2.x)
â”œâ”€â”€ VERSION                # Version file (3.0.0)
â”œâ”€â”€ LICENSE                # BSD-3-Clause license
â”œâ”€â”€ README.md              # Main documentation
â”œâ”€â”€ CHANGELOG.md           # Version history
â””â”€â”€ releasenotes.txt       # Legacy release notes
```

## ğŸ“š Documentation (`docs/`)

```
docs/
â”œâ”€â”€ QUICKSTART.md          # 5-minute setup guide
â”œâ”€â”€ ARCHITECTURE.md        # Technical architecture
â””â”€â”€ TROUBLESHOOTING.md     # Problem solving guide
```

**Quick Links:**
- **Getting Started**: [docs/QUICKSTART.md](docs/QUICKSTART.md)
- **Understanding RedELK**: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)
- **Need Help?**: [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md)

## ğŸ”§ Scripts (`scripts/`)

```
scripts/
â”œâ”€â”€ generate-certificates.py   # Auto-generate TLS certificates
â””â”€â”€ health-check.py           # System health monitoring
```

**Usage:**
```bash
# Generate certificates
python3 scripts/generate-certificates.py --auto

# Check system health
python3 scripts/health-check.py
```

## ğŸ³ ELK Server (`elkserver/`)

Main server deployment directory.

### Docker Configuration
```
elkserver/
â”œâ”€â”€ redelk-full-v3.yml     # Modern Docker Compose (RECOMMENDED)
â”œâ”€â”€ redelk-full.yml        # Legacy full install (v2.x)
â”œâ”€â”€ redelk-limited.yml     # Legacy limited install
â”œâ”€â”€ redelk-dev.yml         # Development mode
â”œâ”€â”€ install-elkserver.sh   # Legacy installer
â””â”€â”€ init-letsencrypt.sh    # Let's Encrypt setup
```

### Docker Images (`elkserver/docker/`)
```
docker/
â”œâ”€â”€ redelk-base/           # Background tasks & enrichment
â”œâ”€â”€ redelk-elasticsearch/  # Elasticsearch 8.x
â”œâ”€â”€ redelk-kibana/        # Kibana 8.x
â”œâ”€â”€ redelk-logstash/      # Logstash 8.x
â””â”€â”€ redelk-jupyter/       # Jupyter notebooks
```

### Mounted Configurations (`elkserver/mounts/`)
```
mounts/
â”œâ”€â”€ bloodhound-config/     # BloodHound settings
â”œâ”€â”€ elasticsearch-config/  # ES JVM options
â”œâ”€â”€ jupyter-workbooks/     # Analysis notebooks
â”œâ”€â”€ logstash-config/       # Log parsing rules
â”œâ”€â”€ nginx-config/          # Web server config
â”œâ”€â”€ redelk-config/         # RedELK settings
â”œâ”€â”€ redelk-logs/          # Application logs
â”œâ”€â”€ redelk-www/           # Web content
â””â”€â”€ sample-data/          # Example data for testing
```

## ğŸ“¡ C2 Server Configuration (`c2servers/`)

Files for deploying agents on Command & Control servers.

```
c2servers/
â”œâ”€â”€ install-c2server.sh         # Legacy installer (v2.x)
â”œâ”€â”€ filebeat/                   # Filebeat configurations
â”‚   â”œâ”€â”€ filebeat_redelk_main.yml.example
â”‚   â””â”€â”€ inputs.d/              # Per-C2 framework configs
â”‚       â”œâ”€â”€ filebeat_cobaltstrike.yml
â”‚       â”œâ”€â”€ filebeat_sliver.yml
â”‚       â”œâ”€â”€ filebeat_poshc2.yml
â”‚       â””â”€â”€ filebeat_outflankstage1.yml
â”œâ”€â”€ cron.d/                    # Scheduled tasks
â””â”€â”€ scripts/                   # Data export scripts
```

**Supported C2 Frameworks:**
- Cobalt Strike
- Sliver
- PoshC2
- Outflank Stage1

## ğŸ”€ Redirector Configuration (`redirs/`)

Files for deploying agents on traffic redirectors.

```
redirs/
â”œâ”€â”€ install-redir.sh           # Legacy installer (v2.x)
â””â”€â”€ filebeat/                  # Filebeat configuration
    â””â”€â”€ filebeat.yml.example   # Redirector config template
```

**Supported Redirectors:**
- Apache HTTP Server
- Nginx
- HAProxy

## ğŸ” Certificates (`certs/`)

TLS certificate configuration.

```
certs/
â””â”€â”€ config.cnf.example         # OpenSSL configuration template
```

**Note:** Certificates are auto-generated by `scripts/generate-certificates.py` or `install.py`.

## ğŸ“– Examples (`example-data-and-configs/`)

Sample configurations and test data.

```
example-data-and-configs/
â”œâ”€â”€ Apache/                    # Apache redirector config
â”œâ”€â”€ CobaltStrike/             # CS malleable profiles
â”œâ”€â”€ ExampleData/              # Sample logs for testing
â”œâ”€â”€ HAProxy/                  # HAProxy config
â”œâ”€â”€ nginx/                    # Nginx redirector config
â”œâ”€â”€ RedELKFieldnames.md       # Field documentation (v1)
â””â”€â”€ RedELKFieldnamesV2.md     # Field documentation (v2)
```

## ğŸ› ï¸ Helper Scripts (`helper-scripts/`)

Utility scripts for maintenance.

```
helper-scripts/
â”œâ”€â”€ export_kibana_config.py   # Export Kibana dashboards
â”œâ”€â”€ get_fields_mappings.sh    # Get ES field mappings
â”œâ”€â”€ reset_ES_readwrite.sh     # Reset ES permissions
â””â”€â”€ requirements.txt          # Python dependencies
```

## ğŸ–¼ï¸ Images (`images/`)

Screenshots and diagrams for documentation.

```
images/
â”œâ”€â”€ redelk_overview.png       # Architecture diagram
â”œâ”€â”€ dashboard-*.png           # Dashboard screenshots
â””â”€â”€ redelk_*.jpg             # UI screenshots
```

## ğŸ—‚ï¸ File Categories

### **Essential for Installation (v3.0)**
- `install.py` - Main installer
- `install-agent.py` - Agent installer
- `redelk` - Management CLI
- `Makefile` - Convenience commands
- `env.template` - Config template
- `scripts/generate-certificates.py` - Cert generator
- `elkserver/redelk-full-v3.yml` - Docker Compose

### **Documentation**
- `README.md` - Getting started
- `CHANGELOG.md` - Version history
- `docs/QUICKSTART.md` - 5-min guide
- `docs/ARCHITECTURE.md` - Technical details
- `docs/TROUBLESHOOTING.md` - Problem solving

### **Configuration Templates**
- `env.template` - Environment variables
- `certs/config.cnf.example` - Certificate config
- `elkserver/mounts/*/` - Service configs

### **Legacy Files (v2.x - Backward Compatibility)**
- `initial-setup.sh` - Old installer
- `elkserver/install-elkserver.sh` - Old ELK installer
- `c2servers/install-c2server.sh` - Old C2 installer
- `redirs/install-redir.sh` - Old redirector installer
- `elkserver/redelk-full.yml` - Old Docker Compose

### **Support Files**
- `helper-scripts/` - Maintenance utilities
- `example-data-and-configs/` - Examples
- `images/` - Documentation images

## ğŸ“¦ Installation Files Generated

During installation, these files are created:

```
Generated Files:
â”œâ”€â”€ elkserver/.env             # Environment variables (from env.template)
â”œâ”€â”€ elkserver/redelk_passwords.cfg  # Generated passwords
â”œâ”€â”€ certs/*.crt               # TLS certificates
â”œâ”€â”€ certs/*.key               # Private keys
â”œâ”€â”€ elkserver/mounts/certs/   # Distributed certificates
â”œâ”€â”€ c2servers.tgz             # C2 deployment package
â””â”€â”€ redirs.tgz               # Redirector deployment package
```

## ğŸš« Files to Ignore

Add to `.gitignore`:

```gitignore
# Generated during installation
*.tgz
certs/*.crt
certs/*.key
certs/*.csr
certs/*.srl
certs/*.pem
elkserver/.env
elkserver/redelk_passwords.cfg
elkserver/mounts/certs/*
sshkey/

# Docker volumes
elkserver/mounts/redelk-logs/*.log
elkserver/mounts/redelk-www/c2logs/*

# Python
__pycache__/
*.pyc
*.pyo
*.egg-info/

# Logs
*.log
redelk-install.log
redelk-inintialsetup.log
```

## ğŸ”„ Upgrade Path

### From v2.x to v3.0

**Keep:**
- All configuration in `elkserver/mounts/redelk-config/`
- Data in Docker volumes
- Custom dashboards and visualizations

**Migrate:**
1. Backup existing installation
2. Run new installer: `python3 install.py`
3. Update agents: `python3 install-agent.py`
4. Copy custom configurations

## ğŸ“Š Size Reference

```
Total Size: ~50MB (without Docker images)

Breakdown:
- Documentation: ~150KB
- Python Scripts: ~100KB
- Docker Configs: ~50KB
- Example Data: ~45MB
- Images: ~5MB
- Templates: ~500KB
```

## ğŸ¯ Quick Navigation

**For Installation:**
1. Start here: [README.md](README.md)
2. Quick setup: [docs/QUICKSTART.md](docs/QUICKSTART.md)
3. Run: `install.py`

**For Operations:**
1. Management: `./redelk` or `make`
2. Health: `scripts/health-check.py`
3. Troubleshooting: [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md)

**For Development:**
1. Architecture: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)
2. Examples: `example-data-and-configs/`
3. Helper scripts: `helper-scripts/`

## ğŸ“ Notes

- **v3.0 files** are the recommended way to use RedELK
- **Legacy (v2.x) files** are kept for backward compatibility
- **Documentation** is comprehensive and up-to-date
- **Examples** help understand configurations
- **Helper scripts** assist with maintenance

---

**Version**: 3.0.0  
**Last Updated**: October 2024  
**Status**: Clean and organized for production use

